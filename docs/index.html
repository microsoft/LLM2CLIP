<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="description" content="LLM2CLIP: Powerful Language Model Unlock Richer Visual Representation">
  <meta name="keywords" content="LLM, CLIP, Multimodal Learning, Vision-Language">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>LLM2CLIP: Powerful Language Model Unlock Richer Visual Representation</title>
  <link rel="icon" href="static/images/logo.png" type="image/x-icon">

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <!-- Fonts and Stylesheets -->
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.4/css/bulma.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <!-- JQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script>
</head>

<body>
  <!-- Header Section -->
  <section class="hero is-primary is-bold">
    <div class="hero-body">
      <div class="container has-text-centered">
          <img src="static/images/logo.png" alt="LLM2CLIP Logo" style="max-width: 100px; margin-bottom: 20px;">
          <h1 class="title is-1">LLM2CLIP: Powerful Language Model Unlocks Richer Visual Representation</h1>
        <h2 class="subtitle is-4">Weiquan Huang<sup>1*</sup>, Aoqi Wu<sup>1*</sup>, Yifan Yang<sup>2†</sup>, Xufang Luo<sup>2</sup>, Yuqing Yang<sup>2</sup>, Liang Hu<sup>1</sup>, Qi Dai<sup>2</sup>, Xiyang Dai<sup>2</sup>, Dongdong Chen<sup>2</sup>, Chong Luo<sup>2</sup>, Lili Qiu<sup>2</sup></h2>
        <div class="is-size-5">
          <span class="author-block"><sup>1</sup>Tongji University</span>,
          <span class="author-block"><sup>2</sup>Microsoft Corporation</span>
        </div>
        <div class="is-size-5">
          <span class="author-block"><sup>*</sup>Equal Contribution, work done during internship at Microsoft Research Asia</span>
          <span class="author-block"><sup>†</sup>Corresponding to: <a class="pl-2" href="mailto:yifanyang@microsoft.com">yifanyang@microsoft.com</a></span>
        </div>
        <div class="publication-links mt-4">
          <!-- Paper Link -->
          <span class="link-block">
            <a href="https://arxiv.org/abs/2411.04997" class="external-link button is-normal is-rounded is-dark">
              <span class="icon"><i class="fas fa-file-pdf"></i></span>
              <span>Paper</span>
            </a>
          </span>
          <!-- Code Link -->
          <span class="link-block">
            <a href="https://github.com/microsoft/LLM2CLIP/" class="external-link button is-normal is-rounded is-dark">
              <span class="icon"><i class="fab fa-github"></i></span>
              <span>Code</span>
            </a>
          </span>
          <!-- Huggingface Link -->
          <span class="link-block">
            <a href="https://huggingface.co/collections/microsoft/llm2clip-672323a266173cfa40b32d4c" class="external-link button is-normal is-rounded is-dark">
              <span class="icon"><img src="static/images/huggingface_logo-noborder.svg" alt=""></span>
              <span>HF</span>
            </a>
          </span>
        </div>
      </div>
    </div>
  </section>

  <!-- News Section -->
  <section class="section">
    <div class="container">
      <h2 class="title is-3  has-text-centered">News <span class="icon"><i class="fas fa-rocket"></i></span></h2>
      <div class="content has-text-left">
        <ul>
           <li><strong>[2024-11-18]</strong> Our Caption-Contrastive finetuned Llama3-8B-CC released on <a href="https://huggingface.co/microsoft/LLM2CLIP-Llama-3-8B-Instruct-CC-Finetuned" target="_blank">HuggingFace</a>, we will try release more version.</li>
           <li><strong>[2024-11-08]</strong> We are training a scaled-up version with ten times the dataset. Updates: EVA ViT-E, InternVL-300M, SigCLIP-SO-400M, and more VLLM results. Stay tuned for the most powerful CLIP models. Thanks for your star!</li>
           <li><strong>[2024-11-06]</strong> OpenAI's CLIP and EVA02's ViT models are now available on <a href="https://huggingface.co/collections/microsoft/llm2clip-672323a266173cfa40b32d4c" target="_blank">HuggingFace</a>.</li>
           <li><strong>[2024-11-01]</strong> Our paper was accepted at the NeurIPS 2024 SSL Workshop!</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Abstract Section -->
  <section class="section">
    <div class="container">
      <h2 class="title is-3 has-text-centered">Abstract</h2>
      <div class="content has-text-centered">
        <p>CLIP is one of the most important multimodal foundational models today, aligning visual and textual signals into a shared feature space using a simple contrastive learning loss on large-scale image-text pairs. What powers CLIP’s capabilities? The rich supervision signals provided by natural language — the carrier of human knowledge — shape a powerful cross-modal representation space. As a result, CLIP supports a variety of tasks, including zero-shot classification, detection, segmentation, and cross-modal retrieval, significantly influencing the entire multimodal domain.</p>
        <p>However, with the rapid advancements in large language models (LLMs) like GPT-4 and LLaMA, the boundaries of language comprehension and generation are continually being pushed. This raises an intriguing question: can the capabilities of LLMs be harnessed to further improve multimodal representation learning? The potential benefits of incorporating LLMs into CLIP are clear. LLMs’ strong textual understanding can fundamentally improve CLIP’s ability to handle image captions, drastically enhancing its ability to process long and complex texts — a well-known limitation of vanilla CLIP. Moreover, LLMs are trained on a vast corpus of text, possessing open-world knowledge. This allows them to expand on caption information during training, increasing the efficiency of the learning process.</p>
        <p>In this paper, we propose LLM2CLIP, a novel approach that embraces the power of LLMs to unlock CLIP’s potential. By fine-tuning the LLM in the caption space with contrastive learning, we extract its textual capabilities into the output embeddings, significantly improving the output layer’s textual discriminability. We then design an efficient training process where the fine-tuned LLM acts as a powerful teacher for CLIP’s visual encoder. Thanks to the LLM’s presence, we can now incorporate longer and more complex captions without being restricted by vanilla CLIP text encoder’s context window and ability limitations. Our experiments demonstrate that this approach brings substantial improvements in cross-modal tasks.</p>
      </div>
    </div>
  </section>

  <!-- Overview Image -->
  <section class="section">
    <div class="container has-text-centered">
      <img src="static/images/main.svg" alt="LLM2CLIP Overview" style="max-width: 100%; height: auto;">
      <p class="mt-4"><strong>LLM2CLIP Overview:</strong> After applying caption contrastive fine-tuning to the LLM, the increased textual discriminability enables more effective CLIP training. We leverage the open-world knowledge and general capabilities of the LLM to better process dense captions, addressing the previous limitations of the pretrained CLIP visual encoder and providing richer, higher-dimensional textual supervision.</p>
    </div>
  </section>

  <!-- Radar Image Section -->
  <section class="section">
    <div class="container has-text-centered">
      <img src="static/images/radar_paper.png" alt="Radar Chart" style="max-width: 80%; height: auto;">
      <p class="mt-4"><strong>LLM2CLIP: Demonstrating excellence across multiple benchmarks.</strong></p>
    </div>
  </section>

  <!-- Experimental Results Section -->
  <section class="section">
    <div class="container">
      <h2 class="title is-3 has-text-centered">Experimental Results</h2>
      <div class="columns is-multiline">
        <div class="column is-full">
          <p style="font-size: 100%" class="has-text-centered">
            To validate our hypothesis, we designed a caption-to-caption retrieval experiment, as shown in Table 1 and Figure 2. Each image in the MS-COCO dataset has five human-annotated captions. We selected the first two captions as positive samples and performed retrieval across the entire validation set. Using the caption retrieval accuracy (CRA), we evaluated the text model’s ability to differentiate between captions, helping us determine which language model is better suited for CLIP. We found that Llama-3 8B achieved only 18.4% top-1 accuracy, while the standard CLIP-ViT-L reached 66.0% top-1 accuracy. As illustrated in Figure 2, the top-1 caption retrieved by original Llama-3 can be entirely unrelated to the query caption, clearly obstructing effective CLIP learning. Therefore, directly using an LLM to guide CLIP’s visual encoder training is highly constrained.
          </p>
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <div style="width: 30%; text-align: center;">
              <table border="1" cellspacing="0" cellpadding="5" style="width: 100%; text-align: center;">
                <caption><b>Comparison of top-1 Caption Retrieval Accuracy (CRA) for various language models in MS COCO validation set.</b></caption>
                <thead>
                  <tr>
                    <th><b>Language Model</b></th>
                    <th><b>CRA</b></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>CLIP-L/14</td>
                    <td>25.2</td>
                  </tr>
                  <tr>
                    <td>EVA02-L/14</td>
                    <td>27.11</td>
                  </tr>
                  <tr style="background-color: #f8d7da;">
                    <td style="color: red;">Llama3-8B</td>
                    <td style="color: red;">5.2</td>
                  </tr>
                  <tr style="background-color: #f8d7da;">
                    <td style="color: red;">Llama3.2-1B</td>
                    <td style="color: red;">5.6</td>
                  </tr>
                  <tr>
                    <td>Llama3-8B-CC</td>
                    <td><b>29.5</b></td>
                  </tr>
                  <tr>
                    <td>Llama3.2-1B-CC</td>
                    <td>29.4</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div style="width: 65%; text-align: center;">
              <img src="static/images/coco_score.svg" alt="COCO Score">
            </div>
          </div>
        </div>
      </div>

      <!-- Cross-Language Retrieval Performance Section -->
      <div class="container is-max-widescreen">
        <div class="rows">
          <div class="rows is-centered">
            <div class="row is-full-width">
              <h2 class="title is-3 has-text-centered"><span class="dvima">LLM2CLIP can make SOTA CLIP even more SOTA ever.</span></h2>
              <div class="content has-text-justified">
                <table border="1" cellspacing="0" cellpadding="5" style="width: 100%; text-align: center;">
                  <caption>Comparison of various text encoders. With only a few epochs of training alongside the LLM, we can significantly enhance the performance of existing pretrained SOTA CLIP models. We freeze the gradients of the LLM and only use it for feature extraction, making the training process very low-cost.</caption>
                  <thead>
                      <tr>
                          <th rowspan="2">Methods</th>
                          <th colspan="2">Flickr30k</th>
                          <th colspan="2">COCO</th>
                          <th colspan="2">ShareGPT4v</th>
                          <th colspan="2">Urban-1k</th>
                          <th colspan="2">DOCCI</th>
                          <th rowspan="2">Average</th>
                          <th rowspan="2">CRA</th>
                      </tr>
                      <tr>
                          <th>I2T</th>
                          <th>T2I</th>
                          <th>I2T</th>
                          <th>T2I</th>
                          <th>I2T</th>
                          <th>T2I</th>
                          <th>I2T</th>
                          <th>T2I</th>
                          <th>I2T</th>
                          <th>T2I</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td><strong>EVA02 Vit-L/14</strong></td>
                          <td>89.8</td>
                          <td>73.3</td>
                          <td>63.8</td>
                          <td>63.8</td>
                          <td>89.3</td>
                          <td>91.9</td>
                          <td>68.5</td>
                          <td>73.3</td>
                          <td>75.0</td>
                          <td>73.4</td>
                          <td>76.2</td>
                          <td>69.8</td>
                      </tr>
                      <tr>
                          <td>&#8195;<strong>+ Jina Bert</strong></td>
                          <td>87.9</td>
                          <td>77.9</td>
                          <td>60.9</td>
                          <td>50.3</td>
                          <td>95.3</td>
                          <td>95.1</td>
                          <td>79.4</td>
                          <td>83.8</td>
                          <td>73.8</td>
                          <td>77.9</td>
                          <td>78.2</td>
                          <td><strong>74.2</strong></td>
                      </tr>
                      <tr>
                          <td>&#8195;<strong>+ Llama3-8B</strong></td>
                          <td>87.1</td>
                          <td>75.3</td>
                          <td>56.4</td>
                          <td>41.6</td>
                          <td>89.3</td>
                          <td>91.4</td>
                          <td>58.6</td>
                          <td>60.9</td>
                          <td>51.7</td>
                          <td>50.6</td>
                          <td>66.3</td>
                          <td>18.4</td>
                      </tr>
                      <tr>
                          <td>&#8195;<strong>+ Llama3-8B-TC</strong></td>
                          <td>92.7</td>
                          <td>82.1</td>
                          <td>68.1</td>
                          <td>54.6</td>
                          <td>97.7</td>
                          <td>98.2</td>
                          <td>88.9</td>
                          <td>93.8</td>
                          <td>85.0</td>
                          <td>87.8</td>
                          <td>84.8</td>
                          <td>71.3</td>
                      </tr>
                      <tr>
                          <td>&#8195;<strong>+ Llama3-8B-CC</strong></td>
                          <td>92.0</td>
                          <td>82.8</td>
                          <td><strong>68.5</strong></td>
                          <td><strong>54.8</strong></td>
                          <td><strong>98.6</strong></td>
                          <td><strong>99.0</strong></td>
                          <td>88.1</td>
                          <td>94.0</td>
                          <td><strong>88.2</strong></td>
                          <td><strong>90.4</strong></td>
                          <td>85.6</td>
                          <td>73.0</td>
                      </tr>
                      <tr>
                          <td>&#8195;<strong>+ Llama3.2-1B-CC</strong></td>
                          <td>91.6</td>
                          <td>81.3</td>
                          <td>65.8</td>
                          <td>52.5</td>
                          <td>98.3</td>
                          <td>98.2</td>
                          <td>84.5</td>
                          <td>91.9</td>
                          <td>83.4</td>
                          <td>86.4</td>
                          <td>83.4</td>
                          <td>72.8</td>
                      </tr>
                      <tr>
                          <td>&#8195;<strong>+ Mistral-Nemo-12B-CC</strong></td>
                          <td><strong>93.5</strong></td>
                          <td><strong>83.7</strong></td>
                          <td><strong>68.5</strong></td>
                          <td>54.7</td>
                          <td><strong>98.6</strong></td>
                          <td>98.9</td>
                          <td><strong>90.4</strong></td>
                          <td><strong>94.3</strong></td>
                          <td>88.0</td>
                          <td>89.7</td>
                          <td><strong>86.0</strong></td>
                          <td>73.3</td>
                      </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Cross-Language Retrieval Performance Table -->
      <div class="container is-max-widescreen">
        <div class="rows">
          <div class="rows is-centered">
            <div class="row is-full-width">
              <div class="content has-text-centered">
                <table border="1" cellspacing="0" cellpadding="5" style="width: 100%; text-align: center;">
                  <colgroup>
                    <col style="width: 10em;"> <!-- 第一列宽度为 15 倍字体大小 -->
                  </colgroup>
                  <caption>Retrieval Performance across Flickr30K-CN and COCO-CN. Even with alignment done solely on English data, our network enables Chinese cross-modal retrieval to go from unusable to SOTA, surpassing models like Wukong that are trained on Chinese datasets.</caption>
                  <thead style="font-size:14px;">
                    <tr>
                      <th rowspan="2">Methods</th>
                      <th colspan="6">Flickr-CN</th>
                      <th colspan="6">COCO-CN</th>
                    </tr>
                    <tr>
                      <th>I2T@1</th>
                      <th>I2T@5</th>
                      <th>I2T@10</th>
                      <th>T2I@1</th>
                      <th>T2I@5</th>
                      <th>T2I@10</th>
                      <th>I2T@1</th>
                      <th>I2T@5</th>
                      <th>I2T@10</th>
                      <th>T2I@1</th>
                      <th>T2I@5</th>
                      <th>T2I@10</th>
                    </tr>
                  </thead>
                  <tbody style="font-size:14px;">
                    <tr>
                      <td>Wukong</td>
                      <td>76.1</td>
                      <td>94.8</td>
                      <td>97.5</td>
                      <td>51.7</td>
                      <td>78.9</td>
                      <td>86.3</td>
                      <td>53.4</td>
                      <td>80.2</td>
                      <td>90.1</td>
                      <td>55.2</td>
                      <td>81.0</td>
                      <td>90.6</td>
                    </tr>
                    <tr>
                      <td>CN-CLIP</td>
                      <td>80.2</td>
                      <td>96.6</td>
                      <td>98.2</td>
                      <td>68.0</td>
                      <td>90.7</td>
                      <td>95.4</td>
                      <td>63.4</td>
                      <td>84.2</td>
                      <td>92.9</td>
                      <td>64.0</td>
                      <td>89.2</td>
                      <td>94.4</td>
                    </tr>
                    <tr>
                      <td>JinaCLIP</td>
                      <td>3.30</td>
                      <td>9.90</td>
                      <td>15.1</td>
                      <td>0.7</td>
                      <td>3.5</td>
                      <td>6.0</td>
                      <td>2.9</td>
                      <td>8.9</td>
                      <td>13.7</td>
                      <td>1.0</td>
                      <td>4.9</td>
                      <td>8.2</td>
                    </tr>
                    <tr>
                      <td>EVA02</td>
                      <td>4.40</td>
                      <td>11.8</td>
                      <td>16.7</td>
                      <td>0.94</td>
                      <td>2.9</td>
                      <td>4.8</td>
                      <td>2.7</td>
                      <td>9.8</td>
                      <td>15.2</td>
                      <td>1.0</td>
                      <td>3.7</td>
                      <td>7.3</td>
                    </tr>
                    <tr style="background-color: #E8F4FF;">
                      <td>&#8195;<strong> &emsp;   + LLM2CLIP</strong></td>
                      <td><strong>86.9</strong></td>
                      <td><strong>98.1</strong></td>
                      <td><strong>99.3</strong></td>
                      <td><strong>75.1</strong></td>
                      <td><strong>92.9</strong></td>
                      <td><strong>96.0</strong></td>
                      <td><strong>69.1</strong></td>
                      <td><strong>92.5</strong></td>
                      <td><strong>97.2</strong></td>
                      <td><strong>70.0</strong></td>
                      <td><strong>92.6</strong></td>
                      <td><strong>96.7</strong></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Llava Performance Table -->
      <div class="container is-max-widescreen">
        <div class="rows">
          <div class="rows is-centered">
            <div class="row is-full-width">
              <h2 class="title is-3 has-text-centered"><span class="dvima">LLM2CLIP can make models like Llava more powerful and comprehensive in performance:</span></h2>
              <div class="content has-text-centered">
                <table border="1" cellspacing="0" cellpadding="5" style="width: 100%; text-align: center;">
                  <colgroup>
                    <col style="width: 10em;"> <!-- 第一列宽度为 15 倍字体大小 -->
                  </colgroup>
                  <caption>Performance of Llava 1.5. We explored whether LLM2CLIP could enhance complex image understanding tasks by modifying Llava's visual encoder. LLM2CLIP improves Llava in 87.5% of benchmarks.</caption>
                  <thead style="font-size:10px;">
                    <tr>
                      <th rowspan="2"><strong>MODEL</strong></th>
                      <th colspan="5"><strong>VQA Datasets</strong></th>
                      <th colspan="3"><strong>Pope Metrics</strong></th>
                      <th colspan="5"><strong>MM Benchmarks</strong></th>
                      <th colspan="3"><strong>Seed Benchmarks</strong></th>
                    </tr>
                    <tr>
                      <th><strong>VQAv2</strong></th>
                      <th><strong>GQA</strong></th>
                      <th><strong>VizWiz</strong></th>
                      <th><strong>SQA-IMG</strong></th>
                      <th><strong>TextVQA</strong></th>
                      <th><strong>Random</strong></th>
                      <th><strong>Adv.</strong></th>
                      <th><strong>Popular</strong></th>
                      <th><strong>MME</strong></th>
                      <th><strong>MMBench</strong></th>
                      <th><strong>MMBench-CN</strong></th>
                      <th><strong>LlavaBench</strong></th>
                      <th><strong>MMVet</strong></th>
                      <th><strong>All</strong></th>
                      <th><strong>IMG</strong></th>
                      <th><strong>Video</strong></th>
                    </tr>
                  </thead>
                  <tbody style="font-size:10px;">
                    <tr style="color: gray;">
                      <td><strong>Llava (Paper)</strong></td>
                      <td>78.5</td>
                      <td>62.0</td>
                      <td>50.0</td>
                      <td>66.8</td>
                      <td>58.2</td>
                      <td>87.3</td>
                      <td>86.1</td>
                      <td>84.2</td>
                      <td>1510.7</td>
                      <td>64.3</td>
                      <td>58.3</td>
                      <td>65.4</td>
                      <td>31.1</td>
                      <td>58.6</td>
                      <td>66.1</td>
                      <td>37.3</td>
                    </tr>
                    <tr>
                      <td><strong>Llava (Rep.)</strong></td>
                      <td>79.04</td>
                      <td>62.86</td>
                      <td>50.57</td>
                      <td>67.97</td>
                      <td>57.48</td>
                      <td>87.7</td>
                      <td><strong>84.85</strong></td>
                      <td>86.3</td>
                      <td>1476.69</td>
                      <td>66.66</td>
                      <td>60.39</td>
                      <td>58.0</td>
                      <td>34.3</td>
                      <td>59.86</td>
                      <td>66.95</td>
                      <td><strong>39.71</strong></td>
                    </tr>
                    <tr style="background-color: #E8F4FF;">
                      <td>&#8195;<strong>  &emsp;  + LLM2CLIP</strong></td>
                      <td><strong>79.80</strong></td>
                      <td><strong>63.15</strong></td>
                      <td><strong>52.37</strong></td>
                      <td><strong>69.92</strong></td>
                      <td><strong>58.35</strong></td>
                      <td><strong>88.55</strong></td>
                      <td>82.76</td>
                      <td><strong>87.75</strong></td>
                      <td><strong>1505.82</strong></td>
                      <td><strong>68.29</strong></td>
                      <td><strong>60.40</strong></td>
                      <td><strong>62.7</strong></td>
                      <td><strong>34.8</strong></td>
                      <td><strong>60.96</strong></td>
                      <td><strong>68.80</strong></td>
                      <td>38.96</td>
                    </tr>
                  </tbody>
                </table>

              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </section>

  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@misc{huang2024llm2clippowerfullanguagemodel,
  title={LLM2CLIP: Powerful Language Model Unlock Richer Visual Representation},
  author={Weiquan Huang and Aoqi Wu and Yifan Yang and Xufang Luo and Yuqing Yang and Liang Hu and Qi Dai and Xiyang Dai and Dongdong Chen and Chong Luo and Lili Qiu},
  year={2024},
  eprint={2411.04997},
  archivePrefix={arXiv},
  primaryClass={cs.CV},
  url={https://arxiv.org/abs/2411.04997}
}</code></pre>
    </div>
  </section>

  <footer class="footer">
    <div class="container">
      <div class="columns is-centered">
        <div class="column">
          <div class="content has-text-centered">
            <p>
                      © 2024 Microsoft <br/>
                  </p>
              </div>
          </div>
      </div>
  </div>
</footer>

</body>
</html>
